(this.webpackJsonpTransitOrb=this.webpackJsonpTransitOrb||[]).push([[0],{32:function(e,t,a){e.exports=a(66)},37:function(e,t,a){},38:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(29),r=a.n(i),o=(a(37),a(38),a(3)),l=a(2),c=a(11),m=a(12),d=a(1),p=a(14),u=a(13),h=a(5),v=a.n(h);function g(e){return new Date(Date.parse(e)).toLocaleTimeString([],{hour:"numeric",minute:"numeric"})}function E(e){return Math.floor((new Date(Date.parse(e))-new Date)/6e4)}var b=function(e){if("BA"===e.bus.MonitoredVehicleJourney.OperatorRef)return s.a.createElement("div",{className:"bus",id:e.bus.MonitoredVehicleJourney.LineRef},s.a.createElement("div",null,s.a.createElement("span",{className:"bold"},e.bus.MonitoredVehicleJourney.DestinationName),s.a.createElement("span",{className:"white"},"<="," ",e.bus.MonitoredVehicleJourney.OriginName)),s.a.createElement("hr",null),s.a.createElement("div",null,e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime?s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"gray"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("span",{className:"bold"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime))):s.a.createElement("span",{className:"bold"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"countdown"},e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime?s.a.createElement("div",{className:"min-math"},E(e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime)):s.a.createElement("div",{className:"min-math"},E(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"min"},"min"))));if("CT"===e.bus.MonitoredVehicleJourney.OperatorRef){var t="Grey-N";return"L3"!==e.bus.MonitoredVehicleJourney.LineRef&&"L4"!==e.bus.MonitoredVehicleJourney.LineRef&&"L5"!==e.bus.MonitoredVehicleJourney.LineRef||(t="Yellow-N"),"B7"===e.bus.MonitoredVehicleJourney.LineRef&&(t="Red-N"),s.a.createElement("div",{className:"bus",id:t},s.a.createElement("div",null,s.a.createElement("span",{title:"Track Vehicle",className:"bold"},e.bus.MonitoredVehicleJourney.VehicleRef?s.a.createElement("span",{className:"gps"},s.a.createElement(o.b,{to:"/vehicular/".concat(e.bus.MonitoredVehicleJourney.OperatorRef,"/").concat(e.bus.MonitoredVehicleJourney.VehicleRef)},e.bus.MonitoredVehicleJourney.LineRef,s.a.createElement("sup",null,"GPS"))):s.a.createElement("span",{className:"no-gps"},e.bus.MonitoredVehicleJourney.LineRef),"=>"),e.bus.MonitoredVehicleJourney.DestinationName),s.a.createElement("hr",null),s.a.createElement("div",null,e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedDepartureTime&&e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedDepartureTime!==e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime?s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"gray"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("span",{className:"bold"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedDepartureTime))):s.a.createElement("span",{className:"bold"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"countdown"},e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedDepartureTime?s.a.createElement("div",{className:"min-math"},E(e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedDepartureTime)):s.a.createElement("div",{className:"min-math"},E(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"min"},"min"))))}return s.a.createElement("div",{className:"bus"},s.a.createElement("div",null,s.a.createElement("span",{title:"Track Vehicle",className:"bold"},e.bus.MonitoredVehicleJourney.VehicleRef?s.a.createElement("span",{className:"gps"},s.a.createElement(o.b,{to:"/vehicular/".concat(e.bus.MonitoredVehicleJourney.OperatorRef,"/").concat(e.bus.MonitoredVehicleJourney.VehicleRef)},e.bus.MonitoredVehicleJourney.LineRef,s.a.createElement("sup",null,"GPS"))):s.a.createElement("span",{className:"no-gps"},e.bus.MonitoredVehicleJourney.LineRef),"=>"),s.a.createElement("span",{className:"bold"},e.bus.MonitoredVehicleJourney.DestinationName)),s.a.createElement("hr",null),s.a.createElement("div",null,e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime?s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"gray"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("span",{className:"bold"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime))):s.a.createElement("span",{className:"bold"},g(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"countdown"},e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime?s.a.createElement("div",{className:"min-math"},E(e.bus.MonitoredVehicleJourney.MonitoredCall.ExpectedArrivalTime)):s.a.createElement("div",{className:"min-math"},E(e.bus.MonitoredVehicleJourney.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"min"},"min"))))},y=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).selectID=function(e){return e.target.select()},n.state={loaded:!1,stopCode:"EMBR",agency:"BA",agencies:[],stopLists:{},stops:[],stopFilter:"",stopsFiltered:[],stop:{Name:"Embarcadero"},buss:[],error:""},n.selectID=n.selectID.bind(Object(d.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n.loadBusss=n.loadBusss.bind(Object(d.a)(n)),n.loadStops=n.loadStops.bind(Object(d.a)(n)),n.stopListIntegrator=n.stopListIntegrator.bind(Object(d.a)(n)),n.updateStopFilter=n.updateStopFilter.bind(Object(d.a)(n)),n.updateStopCode=n.updateStopCode.bind(Object(d.a)(n)),n.agencyCodeLengthMap={AM:3,PE:3,VC:3,BA:4,EM:4,SA:4,AC:5,CT:5,CC:5,DE:5,FS:5,GF:5,GG:5,MA:5,RV:5,SC:5,SF:5,SR:5,UC:5,VN:5,WC:5,SS:6,WH:6,SM:6,ST:6,TD:6,"3D":6,CE:7,CM:7,SO:7},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;v.a.get("https://api.511.org/transit/operators?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON").then((function(t){var a=t.data.filter((function(e){return!!e.WebSite}));e.setState({agencies:a})})),this.loadBusss()}},{key:"handleSubmit",value:function(e){this.setState({error:""}),e.preventDefault(),this.loadBusss()}},{key:"loadBusss",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.agency,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.stopCode;v.a.get("https://api.511.org/transit/StopMonitoring?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON&agency=".concat(t,"&stopCode=").concat(a)).then((function(t){var a=t.data.ServiceDelivery.StopMonitoringDelivery.MonitoredStopVisit;e.setState({buss:a})})).catch((function(t){return e.setState({buss:[],error:"[".concat(t.toString(),"]")})}))}},{key:"updateAgency",value:function(e){var t=this;return function(e){var a,n=e.currentTarget.value,s=[];t.state.stopLists[n]?(a=(s=t.state.stopLists[n])[0],t.setState({stopFilter:"",stopsFiltered:s,stopCode:a.id,buss:[],loaded:!0,stop:a,stops:s,agency:n,error:""}),t.loadBusss(n,a.id)):t.setState({agency:e.currentTarget.value,stop:{},stops:[],stopFilter:"",stopsFiltered:[],stopCode:"",buss:[],loaded:!1,error:""})}}},{key:"loadStops",value:function(e){var t=this;this.setState({loaded:!0}),v.a.get("".concat("/TransitOrb","/stopLists/stopList").concat(this.state.agency,".json")).then((function(e){t.stopListIntegrator(e)})).catch((function(e){v.a.get("https://api.511.org/transit/stops?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON&operator_id=".concat(t.state.agency)).then((function(e){t.stopListIntegrator(e)}))}))}},{key:"stopListIntegrator",value:function(e){var t=this;if("BA"===this.state.agency){var a=e.data.Contents.dataObjects.ScheduledStopPoint.filter((function(e){return!e.id.includes("place")&&!e.Name.includes("Enter/Exit :")})),n=this.state.stopCode||"EMBR",s=a.filter((function(e){return e.id===n.toUpperCase()}))[0]||a.filter((function(e){return"EMBR"===e.id}))[0];this.setState({stopFilter:"",stopsFiltered:a,stopLists:{BA:a},stopCode:s.id,stops:a,stop:s}),this.loadBusss(this.state.agency,s.id)}else{var i=e.data.Contents.dataObjects.ScheduledStopPoint,r=i.filter((function(e){return e.id===t.state.stopCode.toUpperCase()}))[0]||i[0],o=this.state.stopLists;o[this.state.agency]=i,this.setState({stopCode:r.id,stopFilter:"",stopsFiltered:i,stopLists:o,stops:i,stop:r}),this.loadBusss(this.state.agency,r.id)}}},{key:"updateStop",value:function(e){var t=this;return function(e){var a=t.state.stopsFiltered[e.currentTarget.value];t.setState({stopCode:a.id,stop:a,error:""}),t.loadBusss(t.state.agency,a.id)}}},{key:"updateStopFilter",value:function(e){var t=this;return function(e){var a=e.currentTarget.value;if(1===a.length&&t.state.stopsFiltered.length<t.state.stops.length&&t.setState({stopsFiltered:t.state.stops}),a.length<3)t.setState({stopFilter:a});else if(a.length<=t.state.stopFilter.length)t.setState({stopFilter:a}),t.state.stopsFiltered.length!==t.state.stops.length&&t.setState({stopsFiltered:t.state.stops});else if(a.length>=3){t.setState({stopFilter:a});var n=a.toLowerCase().split(" "),s=t.state.stopsFiltered.filter((function(e){return n.every((function(t){return e.Name.toLowerCase().includes(t)}))}));if(t.setState({stopsFiltered:s}),s[0]){var i=s[0];t.state.stopCode!==i.id&&(t.setState({stopCode:i.id,stop:i,error:""}),t.loadBusss(t.state.agency,i.id))}}}}},{key:"updateStopCode",value:function(e){var t=this;return function(e){var a=e.currentTarget.value;if(a.length<=t.agencyCodeLengthMap[t.state.agency]&&t.setState({stopCode:a}),a.length===t.agencyCodeLengthMap[t.state.agency]){t.setState({error:""});var n=a.toUpperCase();if(v.a.get("https://api.511.org/transit/StopMonitoring?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON&agency=".concat(t.state.agency,"&stopCode=").concat(n)).then((function(e){var a=e.data.ServiceDelivery.StopMonitoringDelivery.MonitoredStopVisit;t.setState({buss:a}),a[0]&&t.setState({stopCode:n})})).catch((function(e){return t.setState({buss:[],error:"[".concat(e.toString(),"]")})})),t.state.stops){var s=t.state.stops.filter((function(e){return e.id.toUpperCase()===n}))[0];s?t.setState({stopsFiltered:t.state.stops,stopFilter:"",stopCode:n,stop:s}):t.setState({stop:{}})}}}}},{key:"render",value:function(){var e,t,a;if(this.state.loaded&&!this.state.stops[0]?e=s.a.createElement("div",null,s.a.createElement("span",null,"Muni and the VTA have ",s.a.createElement("span",{className:"stops-number"},"~3500")," stops,"),s.a.createElement("br",null),s.a.createElement("span",null,"ACTransit more than ",s.a.createElement("span",{className:"stops-number"},"5000"),".")):this.state.loaded&&this.state.stops[0]&&this.state.stopFilter?e=s.a.createElement("div",null,"Loaded ",s.a.createElement("span",{className:"stops-number"},this.state.stops.length)," stops.",s.a.createElement("br",null),this.state.stopsFiltered.length===this.state.stops.length?"":s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"stops-number"},this.state.stopsFiltered.length)," in Filter.")):this.state.loaded&&this.state.stops[0]&&(e=s.a.createElement("div",null,"Loaded ",s.a.createElement("span",{className:"stops-number"},this.state.stops.length)," stops.",s.a.createElement("br",null))),this.state.agencies){var n=0;t=this.state.agencies.map((function(e){return s.a.createElement("option",{value:e.Id,key:n++},e.ShortName?e.ShortName:e.Name," ",e.ShortName&&e.ShortName!==e.Name?"(".concat(e.Name,")"):"")}))}if(this.state.stopsFiltered){var i=0;a=this.state.stopsFiltered.map((function(e){return s.a.createElement("option",{key:i,value:i++},e.Name," (",e.id,")")}))}var r,l="",c=s.a.createElement("div",{className:"bust"},"No Tracked Vehicles.",s.a.createElement("br",null),s.a.createElement("span",{className:"update",onClick:this.handleSubmit},"Check again"),", check your inputs, or check the schedule. ",s.a.createElement("span",{className:"error"},this.state.error));if(this.state.buss[0]){l=this.state.buss[0].MonitoredVehicleJourney.MonitoredCall.StopPointName;var m=0;c=this.state.buss.map((function(e){return s.a.createElement(b,{bus:e,key:m++})}))}if(this.state.stopCode.length===this.agencyCodeLengthMap[this.state.agency]&&(r=s.a.createElement(o.b,{to:"/anystop/".concat(this.state.agency,"/").concat(this.state.stopCode)},s.a.createElement("div",{className:"map-link"},"View"))),this.state.stop.Location){var d=this.state.stop;r=s.a.createElement(o.b,{to:{pathname:"/anystop/".concat(this.state.agency,"/").concat(this.state.stop.id),state:{stop:d}}},s.a.createElement("div",{className:"map-link"},"View"))}return s.a.createElement("div",{className:"/search"===this.props.location.pathname?"transit-search":"transit-off"},s.a.createElement("div",{className:"agency-upper"},s.a.createElement("div",{className:"radios"},s.a.createElement("div",{className:"short-title"},"Agency ShortList:"),s.a.createElement("div",{className:"radio-one"},s.a.createElement("label",null,s.a.createElement("input",{type:"radio",onChange:this.updateAgency(),checked:"SF"===this.state.agency,value:"SF"}),"SF"),s.a.createElement("label",null,s.a.createElement("input",{type:"radio",onChange:this.updateAgency(),checked:"GG"===this.state.agency,value:"GG"}),"GG"),s.a.createElement("label",null,"\xa0\xa0\xa0",s.a.createElement("input",{type:"radio",onChange:this.updateAgency(),checked:"BA"===this.state.agency,value:"BA"}),"Bart")),s.a.createElement("div",{className:"radio-two"},s.a.createElement("label",null,s.a.createElement("input",{type:"radio",onChange:this.updateAgency(),checked:"AC"===this.state.agency,value:"AC"}),"AC"),s.a.createElement("label",null,s.a.createElement("input",{type:"radio",onChange:this.updateAgency(),checked:"SM"===this.state.agency,value:"SM"}),"Sam"),s.a.createElement("label",null,s.a.createElement("input",{type:"radio",onChange:this.updateAgency(),checked:"MA"===this.state.agency,value:"MA"}),"Marin"))),s.a.createElement("span",{className:"agency-code"},this.state.agency)),s.a.createElement("div",{className:"agencies-string"},"All ",this.state.agencies.length," Transit Agencies:"),s.a.createElement("div",{className:"agency"},s.a.createElement("select",{className:"agency-select",value:this.state.agency,onChange:this.updateAgency(),onMouseDown:this.updateAgency()},t),s.a.createElement("div",{className:"politics"},"(too many? i agree! ",s.a.createElement("a",{href:"https://www.seamlessbayarea.org/",target:"_blank",rel:"noopener noreferrer"},"Seamless Bay Area"),")")),s.a.createElement("hr",null),s.a.createElement("div",{className:"slow"},this.state.loaded?this.state.stops[0]?s.a.createElement("button",{disabled:!0,className:"stop-loads"},"Loaded"):s.a.createElement("button",{disabled:!0,className:"stop-loads"},"Loading"):s.a.createElement("button",{className:"load-stops",onClick:this.loadStops},"Load Stops"),e),s.a.createElement("select",{disabled:!this.state.stopsFiltered[0],className:"stop-select",onChange:this.updateStop()},this.state.stop.id?s.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:"0"},this.state.stop.Name," (",this.state.stop.id,")"):"",a),s.a.createElement("br",null),s.a.createElement("input",{type:"text",value:this.state.stopFilter,className:"stop-filter",onChange:this.updateStopFilter(),disabled:!this.state.loaded,placeholder:this.state.loaded?"Type to Search":"Load Stops to Search"}),s.a.createElement("br",null),s.a.createElement("div",{className:"stop-info"},s.a.createElement("div",{className:"stop-title",onClick:this.handleSubmit},this.state.stop.Name?this.state.stop.Name:l,s.a.createElement("div",null,"Tap to ReFresh")),s.a.createElement("div",null,s.a.createElement("input",{type:"BA"===this.state.agency||"AM"===this.state.agency?"text":"number",id:"stop-id",placeholder:"Stop Code",value:this.state.stopCode,onFocus:this.selectID,onChange:this.updateStopCode()}),r)),c)}}]),a}(s.a.Component),f=Object(l.f)(y);var C=Object(l.f)((function(e){var t=e.location.pathname.substring(1);return document.title="TransitOrb - ".concat(t),s.a.createElement("div",{className:"transit-header"},s.a.createElement(o.b,{to:"/search"},s.a.createElement("div",{title:"Search",className:"/search"===e.location.pathname?"transit-switch-on":"transit-switch-off"},s.a.createElement("span",{title:"Search",role:"img","aria-label":"magnifying glass emoji"},"\ud83d\udd0d"))),s.a.createElement(o.b,{to:"/saved"},s.a.createElement("div",{title:"My Stops",className:e.location.pathname.includes("/saved")?"transit-switch-on":"transit-switch-off"},s.a.createElement("span",{title:"My Stops",role:"img","aria-label":"map pin emoji"},"\ud83d\udccd"))),s.a.createElement(o.b,{to:"/vehicular"},s.a.createElement("div",{id:"busemoji",className:e.location.pathname.includes("/vehicular")?"transit-switch-on":"transit-switch-off"},s.a.createElement("span",{title:"Vehicular Tracking",role:"img","aria-label":"bus emoji"},"\ud83d\ude8c"))),s.a.createElement(o.b,{to:"/anystop"},s.a.createElement("div",{title:"Stop Departures",className:e.location.pathname.includes("/anystop")?"transit-switch-on":"transit-switch-off"},s.a.createElement("span",{title:"Live Departures",role:"img","aria-label":"bus stop emoji"},"\ud83d\ude8f"))),s.a.createElement(o.b,{to:"/user"},s.a.createElement("div",{title:"User",className:"/user"===e.location.pathname?"transit-switch-on":"transit-switch-off"},s.a.createElement("span",{title:"User Settings",role:"img","aria-label":"user emoji"},"\ud83d\udc64"))))})),N=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).selectID=function(e){return e.target.select()},n.state={vehicleNumber:n.props.match.params.vehicleNumber?n.props.match.params.vehicleNumber.toUpperCase():"",agency:n.props.match.params.agency?n.props.match.params.agency.toUpperCase():"SF"},n.loadVehicle=n.loadVehicle.bind(Object(d.a)(n)),n.updateVehicleNumber=n.updateVehicleNumber.bind(Object(d.a)(n)),n.updateAgency=n.updateAgency.bind(Object(d.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n.selectID=n.selectID.bind(Object(d.a)(n)),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){document.title="TransitOrb - Vehicular Tracking",this.loadVehicle()}},{key:"componentDidUpdate",value:function(e,t){this.props.match.params.vehicleNumber!==e.match.params.vehicleNumber&&this.loadVehicle()}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.history.push("/vehicular/".concat(this.state.agency,"/").concat(this.state.vehicleNumber)),this.loadVehicle()}},{key:"loadVehicle",value:function(){var e=this,t={VehicleRef:this.props.match.params.vehicleNumber},a=this.state.agency.toUpperCase();v.a.get("https://api.511.org/transit/VehicleMonitoring?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&agency=".concat(a,"&format=json&vehicleID=").concat(t.VehicleRef)).then((function(n){n.data.Siri.ServiceDelivery.VehicleMonitoringDelivery.VehicleActivity&&(t=n.data.Siri.ServiceDelivery.VehicleMonitoringDelivery.VehicleActivity[0].MonitoredVehicleJourney),e.setState({vehicleNumber:t.VehicleRef,vehicle:t,agency:a}),document.title="TransitOrb - Vehicular Tracking\n                    ".concat(t.OperatorRef?"- ".concat(t.OperatorRef," #").concat(t.VehicleRef):"")}))}},{key:"updateVehicleNumber",value:function(e){var t=this;return function(e){var a=e.currentTarget.value;t.setState({vehicleNumber:a})}}},{key:"updateAgency",value:function(e){var t=this;return function(e){var a=e.currentTarget.value;a.length<=2&&t.setState({agency:a})}}},{key:"render",value:function(){var e,t,a=this,n=s.a.createElement("div",{className:"vehicle-info"},"No Tracked Vehicle"),i="";(this.state.vehicle&&this.state.vehicle.VehicleLocation&&(e=s.a.createElement("iframe",{title:"gFrame",frameBorder:"1",src:"https://www.google.com/maps/embed/v1/place?zoom=14&q=".concat(this.state.vehicle.VehicleLocation.Latitude,",").concat(this.state.vehicle.VehicleLocation.Longitude,"&key=AIzaSyAIe8CQdaU5qYMgUBimNtNLtz6MKhODsNU")},"Loading Map...")),this.state.vehicle&&this.state.vehicle.MonitoredCall)&&(n=s.a.createElement("div",{className:"vehicle-info"},s.a.createElement("span",null,s.a.createElement("span",{className:"no-gps"},this.state.vehicle.LineRef),s.a.createElement("span",{className:"bold"},"=>")),s.a.createElement("div",null,s.a.createElement("span",{className:"bold"},this.state.vehicle.DestinationName),s.a.createElement("div",null,s.a.createElement(o.b,{to:"/anystop/".concat(this.state.agency,"/").concat(this.state.vehicle.DestinationRef)},s.a.createElement("div",{className:"map-link"},s.a.createElement("span",{title:"bus stop",role:"img","aria-label":"bus stop emoji"},"\ud83d\ude8f"),this.state.vehicle.DestinationRef))))),t="CT"===this.state.agency?this.state.vehicle.MonitoredCall.ExpectedDepartureTime:this.state.vehicle.MonitoredCall.ExpectedArrivalTime,i=s.a.createElement("div",{className:"stop"},s.a.createElement("div",null,s.a.createElement("span",{className:"bold"},this.state.vehicle.MonitoredCall.StopPointName),s.a.createElement(o.b,{to:"/anystop/".concat(this.state.agency,"/").concat(this.state.vehicle.MonitoredCall.StopPointRef)},s.a.createElement("div",{className:"map-link"},s.a.createElement("span",{title:"bus stop",role:"img","aria-label":"bus stop emoji"},"\ud83d\ude8f"),this.state.vehicle.MonitoredCall.StopPointRef))),s.a.createElement("hr",null),s.a.createElement("div",null,t&&t!==this.state.vehicle.MonitoredCall.AimedDepartureTime?s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"gray"},g(this.state.vehicle.MonitoredCall.AimedArrivalTime)),s.a.createElement("span",{className:"bold"},g(t))):s.a.createElement("span",{className:"bold"},"Scheduled ",g(this.state.vehicle.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"countdown"},t&&t!==this.state.vehicle.MonitoredCall.AimedDepartureTime?s.a.createElement("div",{className:"min-math"},E(t)):s.a.createElement("div",{className:"min-math"},E(this.state.vehicle.MonitoredCall.AimedArrivalTime)),s.a.createElement("div",{className:"min"},"min")))));var r=s.a.createElement("div",{className:"future-stops"},s.a.createElement("div",{className:"stop"},"No Future Stops")),l=0;return this.state.vehicle&&this.state.vehicle.OnwardCalls&&this.state.vehicle.OnwardCalls.OnwardCall[0]&&(r=s.a.createElement("div",{className:"future-stops"},i,this.state.vehicle.OnwardCalls.OnwardCall.map((function(e){var t;return t="CT"===a.state.agency.toUpperCase()?e.ExpectedDepartureTime:e.ExpectedArrivalTime,s.a.createElement("div",{className:"stop",key:l++},s.a.createElement("div",null,s.a.createElement("span",{className:"bold"},e.StopPointName),s.a.createElement(o.b,{to:"/anystop/".concat(a.state.agency,"/").concat(e.StopPointRef)},s.a.createElement("div",{className:"map-link"},s.a.createElement("span",{title:"bus stop",role:"img","aria-label":"bus stop emoji"},"\ud83d\ude8f"),e.StopPointRef))),s.a.createElement("hr",null),s.a.createElement("div",null,t&&t!==e.AimedDepartureTime?s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"gray"},g(e.AimedArrivalTime)),s.a.createElement("span",{className:"bold"},g(t))):s.a.createElement("span",{className:"bold"},"Scheduled ",g(e.AimedArrivalTime)),s.a.createElement("div",{className:"countdown"},t?s.a.createElement("div",{className:"min-math"},E(t)):s.a.createElement("div",{className:"min-math"},E(e.AimedArrivalTime)),s.a.createElement("div",{className:"min"},"min"))))})))),s.a.createElement("div",{className:"vehicular"},s.a.createElement("div",{className:"short-title"},"Vehicular Tracking",this.state.vehicle&&this.state.vehicle.VehicleRef&&this.state.vehicle.OperatorRef?" - ".concat(this.state.vehicle.OperatorRef," #").concat(this.state.vehicle.VehicleRef):""),s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",id:"vehicle-agency",placeholder:"Agency",value:this.state.agency,onFocus:this.selectID,onChange:this.updateAgency()}),s.a.createElement("input",{type:"number",id:"vehicle-number",placeholder:"Vehicle",value:this.state.vehicleNumber,onFocus:this.selectID,onChange:this.updateVehicleNumber()}),this.state.vehicle&&this.state.vehicle.Monitored?s.a.createElement("input",{type:"submit",value:"ReLoad"}):s.a.createElement("input",{type:"submit",value:"Load"}),s.a.createElement("br",null),s.a.createElement("a",{className:"vehicular-feedback",href:"https://www.sfmta.com/getting-around/muni/muni-feedback",target:"_blank",rel:"noopener noreferrer"},"SFMUNI Vehicle Numbers")),n,s.a.createElement("div",{className:"g-frame"},e),r)}}]),a}(s.a.Component),S=Object(l.f)(N),M=a(19);var A=function(e){var t=Object(n.useState)([]),a=Object(M.a)(t,2),i=a[0],r=a[1],l=Object(n.useState)(""),c=Object(M.a)(l,2),m=c[0],d=c[1],p=function(){v.a.get("https://api.511.org/transit/StopMonitoring?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON&agency=".concat(e.agency,"&stopCode=").concat(e.stopCode)).then((function(t){var a=t.data.ServiceDelivery.StopMonitoringDelivery.MonitoredStopVisit;e.filterIN&&(a=a.filter((function(t){return e.filterIN.includes(t.MonitoredVehicleJourney.LineRef)}))),e.filterOUT&&(a=a.filter((function(t){return!e.filterOUT.includes(t.MonitoredVehicleJourney.LineRef)}))),e.limit&&(a=a.slice(0,e.limit)),r(a)})).catch((function(e){return d("[".concat(e.toString(),"]"))}))};Object(n.useEffect)(p,[]);var u,h=s.a.createElement("div",{className:"bust"},"No Tracked Vehicles to show.",s.a.createElement("br",null),s.a.createElement("span",{className:"update",onClick:function(){d(""),p()}},"Check again"),", check your inputs, or check the schedule. ",s.a.createElement("span",{className:"error"},m));if(i[0]){u=i[0].MonitoredVehicleJourney.MonitoredCall.StopPointName;var g=0;h=i.map((function(e){return s.a.createElement(b,{bus:e,key:g++})}))}return s.a.createElement("div",{className:"any-stop"},s.a.createElement("div",{className:"header"},s.a.createElement(o.b,{to:"/anystop/".concat(e.agency,"/").concat(e.stopCode)},s.a.createElement("div",{className:"map-link"},s.a.createElement("span",{title:"bus stop",role:"img","aria-label":"bus stop emoji"},"\ud83d\ude8f"),e.title?e.title:u||"".concat(e.agency,"#").concat(e.stopCode)))),h)},V=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).selectID=function(e){return e.target.select()},n.state={stopCode:n.props.match.params.stopCode?n.props.match.params.stopCode.toUpperCase():"",agency:n.props.match.params.agency?n.props.match.params.agency.toUpperCase():"SF",stop:n.props.location.state?n.props.location.state.stop:{},buss:[],error:""},n.loadBusss=n.loadBusss.bind(Object(d.a)(n)),n.loadStopList=n.loadStopList.bind(Object(d.a)(n)),n.stopListIntegrator=n.stopListIntegrator.bind(Object(d.a)(n)),n.updateStopCode=n.updateStopCode.bind(Object(d.a)(n)),n.selectID=n.selectID.bind(Object(d.a)(n)),n.agencyCodeLengthMap={AM:3,PE:3,VC:3,BA:4,EM:4,SA:4,AC:5,CT:5,CC:5,DE:5,FS:5,GF:5,GG:5,MA:5,RV:5,SC:5,SF:5,SR:5,UC:5,VN:5,WC:5,SS:6,WH:6,SM:6,ST:6,TD:6,"3D":6,CE:7,CM:7,SO:7},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){document.title="TransitOrb - Live Departures - ".concat(this.state.agency," ").concat(this.state.stopCode?"#".concat(this.state.stopCode):""),this.loadBusss()}},{key:"loadBusss",value:function(){var e=this;this.state.stopCode.length===this.agencyCodeLengthMap[this.state.agency]&&v.a.get("https://api.511.org/transit/StopMonitoring?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON&agency=".concat(this.state.agency,"&stopCode=").concat(this.state.stopCode)).then((function(t){var a=t.data.ServiceDelivery.StopMonitoringDelivery.MonitoredStopVisit;e.setState({buss:a})})).catch((function(t){return e.setState({buss:[],error:"[".concat(t.toString(),"]")})}))}},{key:"loadStopList",value:function(){var e=this;v.a.get("".concat("/TransitOrb","/stopLists/stopList").concat(this.state.agency,".json")).then((function(t){e.stopListIntegrator(t)})).catch((function(t){v.a.get("https://api.511.org/transit/stops?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON&operator_id=".concat(e.state.agency)).then((function(t){e.stopListIntegrator(t)}))}))}},{key:"stopListIntegrator",value:function(e){var t=this,a=e.data.Contents.dataObjects.ScheduledStopPoint.filter((function(e){return e.id===t.state.stopCode.toUpperCase()}))[0]||{};this.setState({stop:a})}},{key:"updateStopCode",value:function(e){var t=this;return function(e){var a=e.currentTarget.value;if(a.length<=t.agencyCodeLengthMap[t.state.agency]&&t.setState({stopCode:a}),a.length===t.agencyCodeLengthMap[t.state.agency]){t.setState({error:""});var n=a.toUpperCase();t.props.history.push("/anystop/".concat(t.state.agency,"/").concat(n)),v.a.get("https://api.511.org/transit/StopMonitoring?api_key=72939361-85f9-4019-aa55-d62e4e7e2e59&Format=JSON&agency=".concat(t.state.agency,"&stopCode=").concat(n)).then((function(e){var a=e.data.ServiceDelivery.StopMonitoringDelivery.MonitoredStopVisit;t.setState({buss:a,stopCode:n}),document.title="TransitOrb - Live Departures - ".concat(t.state.agency," #").concat(n)})).catch((function(e){return t.setState({buss:[],error:"[".concat(e.toString(),"]")})}))}}}},{key:"render",value:function(){var e,t=this,a=s.a.createElement("div",{className:"bust"},"No Tracked Vehicles to show.",s.a.createElement("br",null),s.a.createElement("span",{className:"update",onClick:function(){t.setState({error:""}),t.loadBusss()}},"Check again"),", check your inputs, or check the schedule. ",s.a.createElement("span",{className:"error"},this.state.error));if(this.state.buss[0]){e=this.state.buss[0].MonitoredVehicleJourney.MonitoredCall.StopPointName;var n=0;a=this.state.buss.map((function(e){return s.a.createElement(b,{bus:e,key:n++})}))}var i=s.a.createElement("button",{disabled:!0,className:"stop-loads"},"Show Map");return this.state.stopCode.length===this.agencyCodeLengthMap[this.state.agency]&&(i=s.a.createElement("button",{className:"load-stops",onClick:this.loadStopList},"Show Map")),this.state.stop.Location&&this.state.stopCode.toUpperCase()===this.state.stop.id&&(i=s.a.createElement("iframe",{title:"gFrame",frameBorder:"1",src:"https://www.google.com/maps/embed/v1/place?zoom=16&q=".concat(this.state.stop.Location.Latitude,",").concat(this.state.stop.Location.Longitude,"&key=AIzaSyAIe8CQdaU5qYMgUBimNtNLtz6MKhODsNU")},"Loading Map...")),s.a.createElement("div",{className:"any-stop-wild-card"},s.a.createElement("div",{className:"short-title"},this.state.agency," ",this.props.match.params.stopCode?"#"+this.props.match.params.stopCode.toUpperCase():""),s.a.createElement("input",{type:"BA"===this.state.agency||"AM"===this.state.agency?"text":"number",id:"stop-id",placeholder:"Stop Code",value:this.state.stopCode,onFocus:this.selectID,onChange:this.updateStopCode()}),s.a.createElement("div",{className:"g-frame"},i),s.a.createElement("div",{className:"stop-title",onClick:function(){t.setState({error:""}),t.loadBusss()}},this.state.stop.Name&&this.state.stopCode.toUpperCase()===this.state.stop.id?this.state.stop.Name:e,s.a.createElement("div",null,"Tap to ReFresh")),s.a.createElement("div",{className:"buss"},a))}}]),a}(s.a.Component),T=Object(l.f)(V);var k=function(){return s.a.createElement("div",{className:"transit-on"},s.a.createElement(A,{title:"Twenty Fourth Street BART",agency:"BA",stopCode:"24TH",filterIN:["YL-S","RD-S"]}),s.a.createElement(A,{title:"Millbrae BART",agency:"BA",stopCode:"MLBR"}),s.a.createElement(A,{title:"CalTrain MillBrae",agency:"CT",stopCode:"70062"}),s.a.createElement(A,{title:"CalTrain San Mateo",agency:"CT",stopCode:"70091"}))};var O=function(){return s.a.createElement("div",{className:"transit-on"},s.a.createElement(A,{agency:"BA",stopCode:"NBRK"}),s.a.createElement(A,{agency:"AC",stopCode:"56144"}),s.a.createElement(A,{agency:"AC",stopCode:"55327"}),s.a.createElement(A,{agency:"AC",stopCode:"59600"}),s.a.createElement(A,{agency:"AC",stopCode:"55165"}))};var L=function(e){return s.a.createElement(o.a,{basename:"/TransitOrb"},s.a.createElement("div",{className:"App"},s.a.createElement("div",{className:"transit-master"},s.a.createElement(C,null),s.a.createElement("div",{className:"transit-switcher"},s.a.createElement("div",{className:"transit"},s.a.createElement(l.b,{exact:!0,path:"/"},s.a.createElement(l.a,{to:"/saved"})),s.a.createElement(l.b,{exact:!0,path:"/saved"},s.a.createElement("div",null,s.a.createElement(A,{agency:"SF",stopCode:"16513",limit:"2"}),s.a.createElement(A,{agency:"SF",stopCode:"13082",limit:"4"})),s.a.createElement("div",null,s.a.createElement(A,{agency:"BA",stopCode:"EMBR",limit:"9"})),s.a.createElement("div",null,s.a.createElement(A,{title:"frisco train",agency:"CT",stopCode:"70012"}),s.a.createElement(A,{title:"CalTrain MillBrae",agency:"CT",stopCode:"70062"})),s.a.createElement("div",null,s.a.createElement(A,{agency:"GG",stopCode:"42006",filterIN:["4"]}),s.a.createElement(A,{agency:"SF",stopCode:"16750",limit:"2",filterIN:["45"],title:"Across from Mario's"}))),s.a.createElement(l.b,{path:"/vehicular/:agency?/:vehicleNumber?",render:function(e){return s.a.createElement(S,e)}}),s.a.createElement(l.b,{path:"/anystop/:agency?/:stopCode?",render:function(e){return s.a.createElement(T,e)}}),s.a.createElement(l.b,{exact:!0,path:"/user"},s.a.createElement("div",null,s.a.createElement("div",{className:"bus"},"COMING SOON"))),s.a.createElement(f,null),s.a.createElement(l.b,{exact:!0,path:"/aa",component:k}),s.a.createElement(l.b,{exact:!0,path:"/da",component:O}),s.a.createElement(l.b,{exact:!0,path:"/weekender"},s.a.createElement(A,{agency:"GG",stopCode:"42006",filterIN:["4"]}),s.a.createElement(A,{agency:"GG",stopCode:"40032"})),s.a.createElement(l.b,{exact:!0,path:"/commuter"},s.a.createElement(A,{agency:"SF",stopCode:"16513",filterOUT:["8","8BX"]}),s.a.createElement(A,{agency:"SF",stopCode:"16750",filterIN:["45"],title:"Across from Mario's"}),s.a.createElement(A,{agency:"SF",stopCode:"13082"})))),s.a.createElement("div",{className:"footer"},s.a.createElement("div",null,s.a.createElement("a",{href:"https://511.org/open-data/transit",title:"Powered by 511 Open Data",target:"_blank",rel:"noopener noreferrer"},s.a.createElement("div",{className:"five-eleven"},s.a.createElement("img",{src:"./511_original_web.png",alt:"511 logo"}))),s.a.createElement("div",{className:"disclaimer"},s.a.createElement("span",null,"Powered by 511 Open Data"),s.a.createElement("br",null),s.a.createElement("span",null,"TransitOrb makes no claim as to the veracity or timeliness"))),s.a.createElement("a",{href:"https://github.com/hechtoid/TransitOrb",title:"View Source on GitHub",target:"_blank",rel:"noopener noreferrer"},s.a.createElement("div",{className:"GitHub"},s.a.createElement("img",{src:"./GitHub-Mark-120px-plus.png",alt:"GitHub Logo"})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.a7c45434.chunk.js.map